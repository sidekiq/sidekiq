<section>
  <div class="grid">
    <h1><%= t('Profiles') %></h1>
    <div><!--spacer--></div>
    <p>
      <a target="blank" href="https://github.com/sidekiq/sidekiq/wiki/Profiling">
        Learn more
      </a>
    </p>
  </div>

<% @profiles = Sidekiq::ProfileSet.new %>
<% if @profiles.size > 0 %>
  <table class="striped">
    <thead>
      <th><%= t('CreatedAt') %></th>
      <th><%= t('Type') %></th>
      <th><%= t('JID') %></th>
      <th><%= t('Token') %></th>
      <th><%= t('Size') %></th>
      <th><%= t('ElapsedTime') %></th>
      <th>&nbsp</th>
    </thead>
    <% @profiles.each do |record| %>
      <tr>
        <td><%= relative_time(record.started_at) %></td>
        <td><%= record.type %> </td>
        <td><%= record.jid %> </td>
        <td><%= record.token %> </td>
        <td><%= format_memory(record.size / 1024) %> </td>
        <td><%= number_with_delimiter(record.elapsed, precision: 2) %> </td>
        <td>
          <div class="linkgroup">
            <% if config[:profile_store_url] %>
              <a class="btn" target="_blank" href="<%= root_path %>profiles/<%= CGI.escape(record.key) %>"><%= t("View") %></a>
            <% end %>
            <a class="btn" href="<%= root_path %>profiles/<%= CGI.escape(record.key) %>/data"><%= t("Data") %></a>
          </div>
        </td>
      </tr>
    <% end %>
  </table>
<% else %>
  <p><%= t('NoDataFound') %></p>
<% end %>
</section>
